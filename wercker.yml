box: kimesawa/sbt_pip_npm
build:
    steps:
        - script:
            name: pip install
            code: pip install -r requirements.txt
        - add-ssh-key:
                keyname: SSH_KEY
                host: $WEBSERVER_IP_ADDRESS
        - add-to-known_hosts:
            hostname: $WEBSERVER_IP_ADDRESS
            fingerprint: e4:b2:39:66:f9:39:0f:7e:e5:f7:ce:32:79:e5:76:66
        # - script:
        #    name: create private key
        #    code: echo $SSH_PRIVATE_KEY > $SSH_PRIVATE_KEY_PATH
        - script:
            name: ansible
            code: ansible-playbook ansible/roles/setup_CentOS7.yml -i ansible/hosts -vv
    after-steps:
        - internal/docker-push:
            username: $DOCKER_HUB_USERNAME
            password: $DOCKER_HUB_PASSWORD
            tag: debug
            repository: kimesawa/result
